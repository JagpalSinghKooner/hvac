---
import Container from '@/components/layout/Container.astro';
import { ChevronRight, Home } from 'lucide-react';

interface Props {
  items?: Array<{
    label: string;
    href: string;
  }>;
}

const { items } = Astro.props;

// Auto-generate breadcrumbs from URL if not provided
const generateBreadcrumbs = () => {
  const pathname = Astro.url.pathname;

  // Skip breadcrumbs on homepage
  if (pathname === '/') {
    return [];
  }

  const segments = pathname.split('/').filter(Boolean);
  const breadcrumbs = [];
  let currentPath = '';

  for (const segment of segments) {
    currentPath += `/${segment}`;

    // Format label (convert slug to title case)
    const label = segment
      .split('-')
      .map(word => word.charAt(0).toUpperCase() + word.slice(1))
      .join(' ');

    breadcrumbs.push({
      label,
      href: currentPath + '/'
    });
  }

  return breadcrumbs;
};

const breadcrumbItems = items || generateBreadcrumbs();

// Don't render if no breadcrumbs
if (breadcrumbItems.length === 0) {
  return null;
}
---

<nav aria-label="Breadcrumb" class="border-b bg-muted/20">
  <Container>
    <ol class="flex items-center gap-2 py-3 text-sm overflow-x-auto">
      <!-- Home -->
      <li class="flex items-center gap-2 shrink-0">
        <a
          href="/"
          class="flex items-center gap-1 text-muted-foreground hover:text-primary transition-colors"
          aria-label="Home"
        >
          <Home className="h-4 w-4" />
          <span class="sr-only">Home</span>
        </a>
        <ChevronRight className="h-4 w-4 text-muted-foreground" />
      </li>

      <!-- Breadcrumb items -->
      {breadcrumbItems.map((item, index) => {
        const isLast = index === breadcrumbItems.length - 1;
        return (
          <li class="flex items-center gap-2 shrink-0">
            {isLast ? (
              <span class="text-foreground font-medium" aria-current="page">
                {item.label}
              </span>
            ) : (
              <>
                <a
                  href={item.href}
                  class="text-muted-foreground hover:text-primary transition-colors"
                >
                  {item.label}
                </a>
                <ChevronRight className="h-4 w-4 text-muted-foreground" />
              </>
            )}
          </li>
        );
      })}
    </ol>
  </Container>
</nav>
