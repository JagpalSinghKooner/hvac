---
import { Check } from 'lucide-react';

interface Benefit {
  title: string;
  description: string;
  icon: string;
}

interface Props {
  benefits: Benefit[];
  headline?: string;
  benefitsHeadline?: string;  // Phase 8A: City-specific headline (overrides headline)
  imageAlt?: string;
  reversed?: boolean;
  variant?: 'default' | 'muted' | 'primary';
}

const {
  benefits,
  headline = "Why Choose Us",
  benefitsHeadline,  // Phase 8A
  imageAlt = "Service benefits",
  reversed = false,
  variant = 'default'
} = Astro.props;

// City-specific headline takes priority
const displayHeadline = benefitsHeadline || headline;

// Variant classes for background
const variantClasses = {
  default: 'bg-background',
  muted: 'bg-muted/30',
  primary: 'bg-primary/5'
};

// Handle empty benefits array
if (!benefits || benefits.length === 0) {
  return null;
}
---

<section class:list={["py-16 md:py-20 lg:py-24 relative overflow-hidden", variantClasses[variant]]}>
  <!-- Decorative background -->
  <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
    <div class="absolute top-20 right-20 w-96 h-96 bg-primary/[0.02] rounded-full blur-3xl"></div>
    <div class="absolute bottom-20 left-20 w-96 h-96 bg-primary/[0.02] rounded-full blur-3xl"></div>
  </div>

  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl relative">
    <div class="grid md:grid-cols-2 gap-8 md:gap-12 lg:gap-16 items-center">
      <!-- Content section -->
      <div class:list={[
        "space-y-6 md:space-y-8",
        reversed ? "md:order-2" : "md:order-1"
      ]}>
        <div class="space-y-4">
          <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading text-foreground leading-tight">
            {displayHeadline}
          </h2>
        </div>

        <!-- Benefits list -->
        <div class="space-y-6" role="list">
          {benefits.map((benefit, index) => (
            <div
              class="flex gap-4 group benefit-item"
              role="listitem"
              style={{ animationDelay: `${index * 0.1}s` }}
            >
              <!-- Check icon -->
              <div class="flex-shrink-0 mt-1">
                <div class="w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors duration-300">
                  <Check className="w-4 h-4 text-primary" aria-hidden="true" />
                </div>
              </div>

              <!-- Benefit content -->
              <div class="flex-1 space-y-1">
                <h3 class="text-lg md:text-xl font-semibold text-foreground group-hover:text-primary transition-colors duration-300">
                  {benefit.title}
                </h3>
                <p class="text-base text-muted-foreground leading-relaxed">
                  {benefit.description}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Image placeholder -->
      <div class:list={[
        "relative",
        reversed ? "md:order-1" : "md:order-2"
      ]}>
        <div class="relative aspect-[4/3] rounded-xl overflow-hidden bg-muted group">
          <div class="absolute inset-0 flex items-center justify-center">
            <div class="text-center space-y-2 px-4">
              <p class="text-sm text-muted-foreground font-medium">
                {imageAlt}
              </p>
              <p class="text-xs text-muted-foreground/60">
                Image placeholder — 1200×900
              </p>
            </div>
          </div>

          <!-- Decorative overlay on hover -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" aria-hidden="true"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .benefit-item {
    opacity: 0;
    animation: fadeInUp 0.6s ease-out forwards;
  }

  @media (prefers-reduced-motion: reduce) {
    .benefit-item {
      opacity: 1;
      animation: none;
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
