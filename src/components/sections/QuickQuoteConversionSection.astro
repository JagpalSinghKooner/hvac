---
import Section from '@/components/layout/Section.astro';
import Container from '@/components/layout/Container.astro';
import PhoneCTA from '@/components/cta/PhoneCTA.astro';
import BookingCTA from '@/components/cta/BookingCTA.astro';
import { CheckCircle } from 'lucide-react';

// Props interface
interface Props {
  variant?: 'default' | 'emergency'; // Default uses primary colors, emergency uses secondary (warm)
  class?: string;
}

const { variant = 'default', class: className } = Astro.props;

// Trust bullets - curated 4 items optimized for conversions
const trustBullets = [
  'Free estimates & diagnostics',
  '10-year warranty on parts & labour',
  'Upfront, no-surprise pricing',
  'Same-day service available'
];

// Background based on variant
const background = variant === 'emergency' ? 'none' : 'primary-light';
const customBg = variant === 'emergency' ? 'bg-secondary-50/30' : '';
---

<Section
  padding="lg"
  background={background}
  fullWidth
  class={`${customBg} ${className}`}
>
  <Container size="default">
    <div class="text-center">

      <!-- Animated heading with gradient text -->
      <h2 class="font-display text-display-md lg:text-display-lg text-center gradient-text mb-4 heading-animate opacity-0">
        Get Your Free HVAC Estimate
      </h2>

      <!-- Subheading with urgency -->
      <p class="font-body text-body-lg text-center text-gray-600 mb-8 subheading-animate opacity-0">
        No obligation • Same-day response • 10-year warranty
      </p>

      <!-- Trust bullets in responsive grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8 max-w-4xl mx-auto">
        {trustBullets.map((bullet, index) => (
          <div
            class="flex items-start gap-3 trust-bullet opacity-0 bg-white/50 backdrop-blur-sm p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow"
            style={`animation-delay: ${200 + index * 150}ms;`}
          >
            <div class="w-5 h-5 mt-0.5 flex-shrink-0 rounded-full bg-primary/20 flex items-center justify-center">
              <CheckCircle className="h-4 w-4 text-primary" aria-hidden="true" />
            </div>
            <span class="text-sm text-foreground font-medium text-left">
              {bullet}
            </span>
          </div>
        ))}
      </div>

      <!-- Dual CTAs centered -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center max-w-lg mx-auto cta-container opacity-0">
        <PhoneCTA variant="hero" showBadge={true} class="w-full sm:w-auto cta-pulse" />
        <BookingCTA variant="hero" class="w-full sm:w-auto cta-pulse" />
      </div>

    </div>
  </Container>
</Section>

<style>
  /* Heading animation - fade in with scale */
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: translateY(-20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .heading-animate {
    animation: fadeInScale 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  /* Subheading animation - fade in */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .subheading-animate {
    animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 200ms;
  }

  /* Trust bullets - staggered fade in from left */
  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-16px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .trust-bullet {
    animation: fadeInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  /* CTA container - fade in up */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .cta-container {
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 800ms;
  }

  /* CTA buttons - subtle pulse on load */
  @keyframes ctaPulse {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.02);
    }
  }

  .cta-pulse {
    animation: ctaPulse 2s cubic-bezier(0.4, 0, 0.2, 1) 1;
    animation-delay: 1.2s;
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .heading-animate,
    .subheading-animate,
    .trust-bullet,
    .cta-container,
    .cta-pulse {
      opacity: 1;
      animation: none;
      transform: none;
    }
  }
</style>
