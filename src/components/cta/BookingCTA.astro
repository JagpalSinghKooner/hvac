---
import { Button } from '@/components/ui/button';
import { Calendar } from 'lucide-react';
import { getEntry } from 'astro:content';
import { cn } from '@/lib/utils';

const businessEntry = await getEntry('business', 'profile');
const business = businessEntry!.data;

// Type assertion for optional booking field
const bookingUrl = business.contact.booking?.url;
if (!bookingUrl) throw new Error('Booking URL not configured');

interface Props {
  variant?: 'header' | 'hero' | 'inline' | 'footer' | 'primary';
  class?: string;
}

const { variant = 'inline', class: className } = Astro.props;

// Map variants to button configuration
const buttonConfig = {
  header: { buttonVariant: 'outline', size: 'sm' },
  hero: { buttonVariant: 'gradient', size: 'lg' },
  inline: { buttonVariant: 'outline', size: 'default' },
  footer: { buttonVariant: 'outline', size: 'default' },
  primary: { buttonVariant: 'gradient', size: 'default' }
} as const;

const config = buttonConfig[variant];
---

<Button
  variant={config.buttonVariant as any}
  size={config.size}
  asChild
  className={cn("gap-2 group", className)}
>
  <a href={bookingUrl} target="_blank" rel="noopener noreferrer">
    <Calendar className="h-4 w-4 transition-transform duration-200 group-hover:scale-110" />
    <span class="font-body">Book Online</span>
  </a>
</Button>
